Повторный отбор в статистике означает многократное извлечение значений из наблюдаемых данных с общей целью определения случайной [вариабельности](https://github.com/sutourisu/Practical-statistic/blob/main/%D0%A0%D0%B0%D0%B7%D0%B2%D0%B5%D0%B4%D1%8B%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7/%D0%9E%D1%86%D0%B5%D0%BD%D0%BA%D0%B8%20%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%B1%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8.md) в статистической величине.

Существуют два главных типа процедур повторного отбора: [*бутстрап*](https://github.com/sutourisu/Practical-statistic/blob/main/%D0%A0%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B8%20%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B2%D1%8B%D0%B1%D0%BE%D1%80%D0%BE%D0%BA/%D0%92%D1%8B%D0%B1%D0%BE%D1%80%D0%BE%D1%87%D0%BD%D0%BE%D0%B5%20%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9%20%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B8%D0%BD%D1%8B.md) и *перестановка*. Бутстрап используется для определения надежности оценки. Перестановочные тесты применяются для проверки гипотез и в типичной ситуации предусматривают две или более групп.

**Ключевые термины для повторного отбора:**

* **Перестановочный тест (permutation test)** - процедура объединения двух или более выборок и случайное (либо исчерпывающее) перераспределение наблюдений в повторные выборки.
* **Повторный отбор (resampling)** - извлечение дополнительных выборок из наблюдаемого набора данных.
* **С возратом либо без возврата (with or without replacement)** - при отборе элемент либо возвращается, либо не возвращается в выборку перед следующим извлечением.

### Перестановочный тест

В процедуре *перестановки* задействуются две или более выборки, как правило, группы в A/B-тесте или другой проверке гипотез. Первый шаг в *перестановочной проверке* гипотезы состоит в объединении результатов из групп A и B. В этом заключается логическое воплощение нулевой гипотезы - варианты эксперимента, которые были предложены группам, не различаются. Затем мы проверяем эту гипотезу путем случайного извлечения групп из этого объединенного множества и смотрим, насколько они отличаются друг от друга. Процедура перестановки такова:

1. Объединить результаты из разных групп в единый набор данных.
2. Перетасовать объединенные данные, затем в случайном порядке извлечь (без возврата) повторную выборку того же размера, что и группа A.
3. Из оставшихся данных в случайном порядке ивзлечь (без возврата) повторную выборку того же размера, что и группа B.
4. Сделать то же для групп C, D и т.д. Теперь вы собрали один набор повторных выборок, которые отражают размеры исходных выборок.
5. В зависимости от статистики или оценки, которая была вычислена для исходных выборок (например, разница в групповых долях), теперь рассчитать ее для повторных выборок и записать; это будет одной итерацией перестановки.
6. Повторить предыдущие шаги R раз для получения перестановочного распределения проверочной статистики.

**Исчерпывающий и бутстраповский перестановочные тесты:**

В дополнение к предыдущей процедуре случайной перетасовки существуют два варианта перестановочного теста:

* исчерпывающий перестановочный тест;
* бутстраповский перестановочный тест;

В исчерпывающем перестановочном тесте вместо простой случайной перетасовки и разделения данных мы фактически выясняем все возможные способы, которыми они могут быть разделены. Это практически осуществимо только для относительно малых размеров выборок. При большом числе повторных перетасовок результаты случайного перестановочного теста аппроксимируют результаты исчерпывающего теста и приближаются к ним в пределе.

В бутстраповском перестановочном тесте извлечения, кратко описанные в шагах 2 и 3 случайного перестановочного теста, делаются *с возвратом*. Благодаря этому процедура повторного отбора моделирует не только случайный элемент в назначении варианта испытуемому, но и случайный элемент в отборе испытуемых из популяции.

**Ключевые идеи для перестановочного теста:**

* В перестановочном тесте многочисленные выборки объединяются и далее перетасовываются.
* Перетасованные значения затем делятся на повторные выборки, и далее вычисляется интересующая статистика.
* Этот процесс повторяется далее, и повторно отобранная статистика сводится в таблицу.
* Сравнение наблюдаемого значения статистики с повторно отобранным распределением позволяет судить о том, могла ли наблюдаемая разница между выборками произойти случайно.
