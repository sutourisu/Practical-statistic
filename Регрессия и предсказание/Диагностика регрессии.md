
В объяснительном моделировании (т. е. в контексте исследования) разнообразные шаги в дополнение к упомянутым ранее метрикам предпринимаются для того, чтобы определить, насколько хорошо модель подогнана к данным; большинство основывается на анализе остатков. Эти шаги непосредственно не решают вопрос предсказательной точности, но они способны обеспечить полезное углубленное понимание предсказательной обстановки.

**Ключевые термины для диагностики регрессии:**

* **Стандартизированные остатки (standardized residuals)** - остатки, деленные на стандартную ошибку остатков.
* **Выбросы (outliers)** - записи, которые находятся вдали от остальной части данных.
* **Влиятельной значение (influental value)** - значение, присутствие или отсутствие которого играет важну роль в уравнении регрессии.
* **Плечо (leverage)** - степень влиятельности, которую отдельная запись имеет на уравнение регрессии.
* **Ненормальные остатки (non-normal residuals)** - ненормально распределенные остатки могут аннулировать некоторые технические условия регрессии;
* **Гетероскедастичность (heterosedasticity)** - ситуация, когда некоторые диапазоны исхода показывают остатки с более высокой дисперсией (что может говорить о предсказателе, который в уравнении отсутствует).
* **Графики частных остатков (partial residual plots)** - диагностический график для выявления связи между переменной исход и одиночным предсказателем.

### Выбросы

Вообще говоря. предельное значение, так называемый выброс, есть такое значение, которое находится вдали от большинства других наблюдений. Как и в случае с [оценками центрального положения](Практическая%20статистика/Разведывательный%20анализ/Оценки%20центрального%20положения) и [вариабельности](Практическая%20статистика/Разведывательный%20анализ/Оценки%20вариабельности), где выбросы необходимо улаживать во избежание проблем, выобросы могут вызывать проблемы с регрессионными моделями. В регрессии выброс - это запись, чье фактическое значение $y$ находится вдали от предсказанного значения. Выбросы можно обнаружить путем обследования стандартизированного остатка, т. е. остатка, деленного на стандартную ошибку остатков.

Не существует статистической теории, которая отделяет выбросы от невыбросов. Вместо этого существую правила в отношении того, насколько далеко от основной части данных должно находиться наблюдение, что его можно было назвать выбросов. Например, в коробчатой диаграмме выбросами являются те точки данных, которые находятся слишком высоко или слишком низко от границ коробки, где "слишком" означает величину, превышающую 1,5 * межквартильный размах. В регрессии метрика стандартизированного остатка используется для определения того, не относится ли запись к классу выбросов.

Для задач с привлечением больших данных выбросы обычно не представляют проблему в подгонке регрессии, используемой в предсказании новых данных. Однако выбросы занимают центральное место в обнаружении аномалий, где отыскание выбросов является смыслом всего дела. Кроме того, выброс может соответствовать случаю мошенничества или нечаянного действия. В любом случае обнаружение выбросов бывает критической потребностью бизнеса.

### Влиятельные значения

Значение, отсутствие которого значимо изменит уравнение регрессии, называется *влиятельным наблюдением*. В регрессии такое значение не обязательно должно ассоциироваться с крупным остатком. В качестве примера рассмотрим регрессионные прямые.

<img src="https://i.imgur.com/k8hv0eP.png">

Пунктирная прямая соответствует регрессии со всеми данными, тогда как сплошная прямая - регрессии с точкой далеко в правом верхнем углу. Безусловно, это значение данных имеет огромное влияние на регрессию, хотя она не связана с крупным выбросом (из полной регрессии). Считается, что это значение данных имеет в регрессии сильное плечо (или рычаг).

В дополнение к стандартизированным остаткам разработали несколько метрик для определения влиятельности отдельной записи на регрессию. Часто встречающейся мерой плеча является *hat-значение*; значения выше $2(P+1)/n$ говорят о данных с высоким плечом.

Еще одна метрика - *расстояние Кука*, которое определяет влияние как комбинацию плеча и размера остатка. Эмпирическое правило состоит в том, что наблюдение имеет высокое влияние, если расстояние Кука превышает $4/(n-P-1)$.

### Гетероскедастичность, ненормальность и коррелированные ошибки

В статистике значительное внимание уделяется распределению остатков. Оказывается, что обычные наименьшие квадраты являются несмещенными, и в некоторых случаях "оптимальным" оценщиком, в условиях широкого диапазона допущений о природе распределения. Это означает, что в большинстве задач исследователям данных не приходится беспокоиться о распределении остатков.

Распределение остатков является релевантным главным образом для подтверждения достоверности формального статистического вывода ([проверок гипотез](Практическая%20статистика/Статистические%20эксперименты%20и%20проверка%20значимости/Проверки%20гипотез) и [p-значений](Практическая%20статистика/Статистические%20эксперименты%20и%20проверка%20значимости/Статистическая%20значимость%20и%20p-значения)), что имеет минимальное значение для исследователей данных, озабоченных главным образом предсказательной точностью. Нормально распределенные ошибки - это признак того, что модель завершена; ошибки, которые не являются нормально распределенными, указывают на то, что модель, возможно, что-то упускает. Для того, чтобы формальный статистический вывод был достоверным, принимается допущение о  том, что остатки нормально распределены, имеют одинаковую дисперсию и являются независимыми.

*Гетероскедастичность* - это отсутствие постоянной остаточной дисперсии по всему  диапазону предсказанных значений. Другими словами, для некоторых частей диапазона ошибки больше, чем для других. Визуализация данных является удобным способом анализа остатков.

### Графики частных остатков и нелинейность

*Графики частных остатков* - это способ визуализации того, насколько хорошо вычисленная подгонка объясняет связь между предсказателем и исходом. Главная идея графика частных остатков состоит в изолировании связи между предсказательной переменной и откликом, *принимая в расчет все другие предсказательные переменные*. Частный остаток можно рассматривать, как "синтетическое результирующее" значение, объединяющее предсказание на основе отдельного предсказателя с фактическим остатком от полного уравнения регресии. Частный остаток для пресказателя $X_i$ - это обычный остаток плюс член регрессии, связанный с $X_i$.
$$Частный~остаток = Остаток + \hat{b_i}X_i$$
где $\hat{b_i}$ - это оценочный регрессионный коэффициент.


**Ключевые идеи для диагностики регрессии:**

* Хотя выбросы могут вызывать проблемы для малых наборов данных, первоочередной интерес к выбросам заключается в выявлении проблем с данными или в локализации аномалий.
* Отдельные записи (включая регрессионные выбросы) могут оказывать большое влияние на уравнение регрессии с малыми данными, но этот эффект размывается в больших данных.
* Если регресионная модель используется для формального статистического вывода, то должны быть проверены некоторые допущения о природе распределения остатков. В общем случае, однако, распределение остатков не имеет критическую важность в науке о данных.
* График частных остатков может использоваться для качественной диагностики подгонки для каждого члена регрессии, возможно приводя к спецификации альтернативной модели.